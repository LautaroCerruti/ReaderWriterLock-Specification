-- Como correr setlog
consult('setlog.pl').
setlog.

-- Como cargar la spec
type_check.
consult('reader-writer-lock.slog').
vcg('reader-writer-lock.slog').
consult('reader-writer-lock-vc.slog').
check_vcs_reader-writer-lock.

-- TTF SetMaxReaders
ttf(rwlock).
applydnf(setMaxReaders(N)).
applysc(setMaxReaders_dnf_1,Readers).
prunett.
applyii(setMaxReaders_dnf_2,N,[-1,0]).
prunett.
applyii(setMaxReaders_dnf_3,N,[2,3]).
prunett.
gentc.
writett.
writetc.
exporttt.

-- TTF acquireRead
ttf(rwlock).
applydnf(acquireRead(P)).
applysp(acquireRead_dnf_1,un(Readers, {P}, Readers_)).
prunett.
applysc(acquireRead_dnf_3,Readers).
prunett.
applyii(acquireRead_dnf_4,MaxReaders,[1,2,3]).
prunett.
gentc.
writett.
writetc.
exporttt.

-- TTF acquireWrite
ttf(rwlock).
applydnf(acquireWrite(P)).
applysc(acquireWrite_dnf_1,Readers).
prunett.
applysc(acquireWrite_dnf_4,Readers).
prunett.
gentc.
writett.
writetc.
exporttt.

-- TTF releaseRead
ttf(rwlock).
applydnf(releaseRead(P)).
applysp(releaseRead_dnf_1,diff(Readers, {P}, Readers_)).
prunett.
applysc(releaseRead_dnf_2,Readers).
prunett.
gentc.
writett.
writetc.
exporttt.

-- TTF releaseWrite
ttf(rwlock).
applydnf(releaseWrite(P)).
applysc(releaseWrite_dnf_2,Readers).
prunett.
gentc.
writett.
writetc.
exporttt.